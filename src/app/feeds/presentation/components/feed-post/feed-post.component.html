<div class="bg-white rounded-xl border border-gray-200 shadow-sm hover:shadow-md transition-shadow duration-300 overflow-hidden">
  
  <!-- Post Header -->
  <app-post-header
    [post]="post"
    [canEditPost]="canEditPost"
    [formattedDate]="formattedDate"
    (profileClick)="navigateToProfile()"
    (deleteClick)="onDeleteClick()"
    (editClick)="onEditClick()">
  </app-post-header>

  <!-- Post Content -->
  <app-post-content
    [content]="post.content"
    [displayContent]="displayContent"
    [showFullContent]="showFullContent"
    [shouldTruncateContent]="shouldTruncateContent"
    [tags]="post.tags || []"
    (toggleContent)="toggleFullContent()">
  </app-post-content>

  <!-- Poll Section -->
  <div class="px-4">
    <app-post-poll
      *ngIf="post.poll"
      [poll]="post.poll"
      (optionClick)="onPollOptionClick($event)">
    </app-post-poll>
  </div>

  <!-- Post Files -->
  <div class="px-4">
    <app-post-files
      [files]="post.files || []"
      (imageClick)="openImageLightbox($event)"
      (fileOpen)="openFile($event)"
      (fileDownload)="downloadFile($event)">
    </app-post-files>
  </div>

  <!-- Post Actions -->
  <app-post-actions
    [post]="post"
    [showActions]="showActions"
    [showComments]="showComments"
    [isLiking]="isLiking"
    [showCommentsSection]="showCommentsSection"
    (likeClick)="onLikeClick()"
    (commentToggle)="showCommentsSection = !showCommentsSection">
  </app-post-actions>

  <!-- Comments Section -->
  <div class="border-t border-gray-100 bg-gray-50" *ngIf="showCommentsSection">
    <app-post-comments 
      [postId]="post.id"
      [commentsCount]="post.comments_count"
      (commentAdded)="onCommentAdded($event)"
      (commentsCountUpdated)="onCommentsCountUpdated($event)">
    </app-post-comments>
  </div>
</div>

<!-- Image Lightbox -->
<app-image-lightbox
  [showLightbox]="showImageLightbox"
  [imageFiles]="imageFiles"
  [currentImageIndex]="currentImageIndex"
  (close)="closeImageLightbox()"
  (previous)="previousImage()"
  (next)="nextImage()"
  (overlayClick)="onLightboxOverlayClick($event)"
  (keydown)="onLightboxKeydown($event)">
</app-image-lightbox>
