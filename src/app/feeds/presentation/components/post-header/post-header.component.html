<!-- Post Header -->
<div class="flex items-center justify-between p-4">
  <div class="flex items-center space-x-3 flex-1 cursor-pointer hover:opacity-80 transition-opacity" (click)="onProfileClick()">
    <img 
      [src]="post.author.profile_picture || '/assets/profile.png'" 
      [alt]="post.author.first_name + ' ' + post.author.last_name"
      class="w-12 h-12 rounded-full object-cover flex-shrink-0"
      onerror="this.src='/assets/profile.png'">
    
    <div class="flex flex-col gap-0.5">
      <div class="flex items-center gap-2">
        <h3 class="text-sm font-semibold text-gray-900 hover:underline leading-tight">
          {{ post.author.first_name }} {{ post.author.last_name }}
        </h3>
        
        <!-- Trending Indicator -->
        <div *ngIf="post.trending_metadata && post.trending_metadata.trending_rank > 5" 
             class="flex items-center gap-1 bg-gradient-to-r from-orange-50 to-red-50 px-2 py-0.5 rounded-full border border-orange-200">
          <i class="fas fa-fire text-orange-500 text-xs"></i>
          <span class="text-xs font-medium text-orange-700">
            Trending
          </span>
        </div>
      </div>
      
      <div class="flex items-center gap-2">
        <p class="text-xs text-gray-500 leading-tight">{{ formattedDate }}</p>
        
        <!-- Edited Indicator -->
        <span *ngIf="isPostEdited" 
              class="text-xs text-gray-500 flex items-center gap-1 px-2 py-0.5 bg-gray-100 rounded-full"
              title="Este post ha sido editado">
          <i class="fas fa-pencil-alt text-xs"></i>
          <span>editado</span>
        </span>
        
        <!-- Engagement Score Indicator -->
        <div *ngIf="post.engagement_score && post.engagement_score > 0" 
             class="text-xs text-gray-500 flex items-center gap-1" 
             [title]="getEngagementTooltip()">
          <i class="fas fa-chart-line"></i>
          <span>{{ post.engagement_score | number:'1.1-1' }}</span>
        </div>
      </div>
    </div>
  </div>

  <!-- Post Actions Menu -->
  <div class="relative" *ngIf="canEditPost">
    <button class="p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded-full transition-all" 
            type="button" 
            (click)="toggleDropdown()">
      <i class="fas fa-ellipsis-h"></i>
    </button>
    
    <!-- Dropdown Menu -->
    <div *ngIf="showDropdown" 
         class="absolute right-0 top-full mt-2 w-48 bg-white rounded-lg shadow-lg border border-gray-200 z-10">
      <div class="py-2">
        <button class="w-full px-4 py-2.5 text-sm text-left transition-colors hover:bg-blue-50 hover:text-blue-600 flex items-center"
                (click)="onEditClick()">
          <i class="fas fa-edit mr-2 w-4"></i>
          Editar
        </button>
        <button class="w-full px-4 py-2.5 text-sm text-left transition-colors hover:bg-red-50 hover:text-red-600 flex items-center" 
                (click)="onDeleteClick()">
          <i class="fas fa-trash mr-2 w-4"></i>
          Eliminar
        </button>
      </div>
    </div>
  </div>
</div>
