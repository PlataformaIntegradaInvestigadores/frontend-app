<!-- profile-data.component.html -->
<div *ngIf="user && !isAuthor"
     class="mx-auto max-w-screen-xl p-4 lg:p-8 flex flex-col md:flex-row justify-center md:justify-start relative">
  <div class="flex flex-col md:flex-row items-center gap-x-4 gap-y-2 w-full">
    <div class="flex justify-center md:justify-start w-full md:w-1/4">
      <div
        class="relative w-32 h-40 sm:w-40 sm:h-48 overflow-hidden rounded border-4 border-gray-200 shadow-xl"
      >
        <img
          class="object-cover w-full h-full"
          [attr.src]="user.profile_picture || 'assets/profile.png'"
          alt="Profile Picture"
        />
      </div>
    </div>
    <div
      class="w-full flex flex-col sm:flex-row md:flex-col md:flex-grow justify-center md:justify-start gap-x-4 gap-y-2"
    >
      <div class="w-full md:border-r pr-7">
        <div class="text-center">
          <strong class="block text-xl sm:text-2xl font-bold mb-2"
            >{{ user.first_name }} {{ user.last_name }}</strong
          >
        </div>
        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mt-6">
          <ng-container *ngIf="user.institution">
            <div class="break-words">
              <strong
                class="block text-base sm:text-lg font-semibold mb-2 text-gray-700"
                >Institution</strong
              >
              <p class="text-sm sm:text-base text-gray-900">
                {{ user.institution }}
              </p>
            </div>
          </ng-container>
          <ng-container *ngIf="user.website">
            <div class="break-words">
              <strong
                class="block text-base sm:text-lg font-semibold mb-2 text-gray-700"
                >Website</strong
              >
              <p class="text-sm sm:text-base text-gray-900">
                <a
                  href="{{ user.website }}"
                  class="text-blue-500 hover:underline"
                  >{{ user.website }}</a
                >
              </p>
            </div>
          </ng-container>
          <ng-container *ngIf="user.investigation_camp">
            <div class="break-words">
              <strong class="block text-base sm:text-lg font-semibold mb-2 text-gray-700">Research Field</strong>
              <p class="text-sm sm:text-base text-gray-900">{{ user.investigation_camp }}</p>
            </div>
          </ng-container>
          <ng-container *ngIf="user.email_institution">
            <div class="break-words">
              <strong
                class="block text-base sm:text-lg font-semibold mb-2 text-gray-700"
                >Institutional Email</strong
              >
              <p class="text-sm sm:text-base text-gray-900">
                {{ user.email_institution }}
              </p>
            </div>
          </ng-container>
        </div>
        <div *ngIf="shouldShowLoggedInMessage" class="text-justify mt-2">
          <p class="text-gray-600">
            Welcome {{ user.first_name }}! It's great to see you here. By
            completing your profile, you can better showcase your professional
            journey and achievements.
          </p>
          <p class="text-gray-600 mt-2">
            Adding details such as your institution, website, and research
            interests can help others in your field find and connect with you
            more easily (click on "Edit Profile").
          </p>
          <p class="text-gray-600 mt-2">
            Remember, every bit of information you add makes your profile richer
            and more impactful. Take a few moments to fill in these details and
            let your professional persona shine!
          </p>
        </div>
        <div *ngIf="shouldShowLoggedOutMessage" class="text-justify mt-6">
          <p class="text-gray-600">
            Welcome to {{ user.first_name }} {{ user.last_name }}'s profile!
            Currently, this profile doesn't have detailed information filled out
            yet.
          </p>
          <p class="text-gray-600 mt-2">
            Encourage {{ user.first_name }} to complete their profile to better
            showcase their professional journey and achievements.
          </p>
          <p class="text-gray-600 mt-2">
            Detailed profiles help in making professional connections and
            collaborations more effective. If you know {{ user.first_name }},
            feel free to suggest them to add more details here.
          </p>
        </div>
      </div>
    </div>
    <div
      *ngIf="user.scopus_id; else noScopusId"
      class="w-full md:w-2/5 flex flex-col justify-center items-center gap-x-4 gap-y-1 mt-2"
    >
      <div class="w-full">
        <div>
          <strong class="block text-md sm:text-lg font-bold mb-1"
            >Citations</strong
          >
          <p>{{ scopusData.citations }}</p>
          <strong class="block text-md sm:text-lg font-bold mt-4 mb-1"
            >SCOPUS ID</strong
          >
          <p>{{ user.scopus_id }}</p>
          <strong class="block text-md sm:text-lg font-bold mt-4 mb-1"
            >Articles</strong
          >
          <p>{{ scopusData.articles }}</p>
        </div>
      </div>
    </div>
    <ng-template #noScopusId>
      <div
        *ngIf="isOwnProfile"
        class="w-full md:w-2/5 flex flex-col justify-center items-center gap-x-4 gap-y-1"
      >
        <div class="w-full px-3 text-center">
          <strong class="block text-sm font-bold mb-1 text-green-500"
            >Keep Going!</strong
          >
          <p class="text-xs text-gray-500 text-justify">
            You don't have a Scopus ID listed yet, but every step you take in
            your research brings you closer to achieving it. If you have a
            Scopus ID, please update your profile and add it to enhance your
            academic visibility. Keep up the great work!
          </p>
        </div>
      </div>
      <div
        *ngIf="!isOwnProfile"
        class="w-full md:w-2/5 flex flex-col justify-center items-center gap-x-4 gap-y-1"
      >
        <div class="w-full px-3 text-center">
          <strong class="block text-sm font-bold mb-1 text-green-500"
            >Encourage Profile Completion</strong
          >
          <p class="text-xs text-gray-500 text-justify">
            {{ user.first_name }} {{ user.last_name }} does not have a Scopus ID
            listed yet. Having a Scopus ID can significantly increase academic
            visibility and make it easier for others to find and cite their
            work. If you know {{ user.first_name }}, please encourage them to
            add their Scopus ID to their profile to enhance their academic
            presence.
          </p>
        </div>
      </div>
    </ng-template>
  </div>
  <button
    *ngIf="isOwnProfile"
    class="absolute top-4 right-4 md:right-8 flex items-center px-4 py-2 bg-white text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-900 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 shadow-sm group"
    (click)="toggleForm()"
  >
    <svg class="w-4 h-4 mr-2 text-gray-500 group-hover:text-gray-700 transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
    </svg>
    <span class="font-medium">Edit Profile</span>
  </button>
  <div
    *ngIf="showForm"
    class="fixed inset-0 z-50 flex items-center justify-center bg-gray-500 bg-opacity-75"
  >
    <app-data-form
      [user]="user"
      (formSubmitted)="toggleForm()"
      (formClosed)="toggleForm()"
    ></app-data-form>
  </div>
</div>

<div *ngIf="authorCentinela && isAuthor"
     class="mx-auto max-w-screen-xl p-4 lg:p-8 flex flex-col md:flex-row justify-center md:justify-start relative">
  <div class="flex flex-col md:flex-row items-center gap-x-4 gap-y-2 w-full">
    <!-- Profile Picture -->
    <div class="flex justify-center md:justify-start w-full md:w-1/4">
      <div
        class="relative w-32 h-40 sm:w-40 sm:h-48 overflow-hidden rounded border-4 border-gray-200 shadow-xl"
      >
        <img
          class="object-cover w-full h-full"
          [src]="'./assets/profile.png'"
          alt="Profile Picture"
        />
      </div>
    </div>
    <div
      class="w-full flex flex-col sm:flex-row md:flex-col md:flex-grow justify-center md:justify-start gap-x-4 gap-y-2">
      <div class="w-full md:border-r pr-7">
        <div class="text-center">
          <strong
            class="block text-xl sm:text-2xl font-bold mb-2">{{ authorCentinela.first_name }} {{ authorCentinela.last_name }}</strong>
        </div>

        <div class="grid grid-cols-1 sm:grid-cols-2 gap-6 mt-6">
          <!-- Información de la Institución y Email -->
          <div class="space-y-6">
            <ng-container *ngIf="authorCentinela.current_affiliation">
              <div class="break-words">
                <strong class="block text-lg font-semibold text-gray-700">Affiliation</strong>
                <p class="text-base text-gray-900">{{ authorCentinela.current_affiliation }}</p>
              </div>
            </ng-container>

            <ng-container *ngIf="authorCentinela.email">
              <div class="break-words">
                <strong class="block text-lg font-semibold text-gray-700">Institutional Email</strong>
                <p class="text-base text-gray-900">{{ authorCentinela.email }}</p>
              </div>
            </ng-container>

          </div>

          <!-- Información de Scopus y Botón -->
          <div class="space-y-6">
            <!-- Información de Scopus -->
            <div>
              <div class="space-y-4">
                <div>
                  <strong class="block text-lg font-bold text-gray-800">Citations</strong>
                  <p class="text-base  text-gray-900">{{ authorCentinela.citation_count }}</p>
                </div>

                <div>
                  <strong class="block text-lg font-bold text-gray-800">Scopus</strong>
                  <p class="text-base  text-gray-900">{{ authorCentinela.scopus_id }}</p>
                </div>

                <div>
                  <strong class="block text-lg font-bold text-gray-800">Articles</strong>
                  <p class="text-base text-gray-900">{{ authorCentinela.articles }}</p>
                </div>
              </div>
            </div>
            <!-- Botón VIEW IN SCOPUS -->
            <div class="flex justify-end">
              <button
                (click)="goToScopus(authorCentinela.scopus_id)"
                class="inline-flex items-center justify-center px-6 py-3 bg-gradient-to-r from-orange-500 to-red-500 text-white font-semibold rounded-lg shadow-md hover:from-orange-600 hover:to-red-600 hover:shadow-lg focus:outline-none focus:ring-2 focus:ring-orange-400 focus:ring-offset-2 transition-all duration-200 transform hover:-translate-y-0.5 group"
              >
                <svg class="w-5 h-5 mr-2 group-hover:scale-110 transition-transform duration-200" fill="currentColor" viewBox="0 0 24 24">
                  <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/>
                </svg>
                <span class="tracking-wide">VIEW IN SCOPUS</span>
                <svg class="w-4 h-4 ml-2 group-hover:translate-x-1 transition-transform duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"></path>
                </svg>
              </button>
            </div>
          </div>
        </div>
      </div>
      <!-- Scopus Information and Line Chart -->
        <div class="w-full md:w-3/5 flex flex-col gap-6 md:pl-4 mt-6 md:mt-0">
          <!-- Line Chart -->
          <ng-container *ngIf="years && charged">
            <div class="flex justify-center items-center">
              <div class="max-h-fit" *ngIf="years[0].series.length > 1">
                <app-evolution-line-chart
                  [multi]="years"
                  [width]="600"
                  [height]="300"
                  [boolean]="true"
                ></app-evolution-line-chart>
              </div>
            </div>
          </ng-container>
        </div>

    </div>

  </div>

  <button
    *ngIf="isOwnProfile"
    class="absolute top-4 right-4 md:right-8 flex items-center px-4 py-2 bg-white text-gray-700 border border-gray-300 rounded-lg hover:bg-gray-50 hover:text-gray-900 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-all duration-200 shadow-sm group"
    (click)="toggleForm()"
  >
    <svg class="w-4 h-4 mr-2 text-gray-500 group-hover:text-gray-700 transition-colors duration-200" fill="none" stroke="currentColor" viewBox="0 0 24 24">
      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path>
    </svg>
    <span class="font-medium">Edit Profile</span>
  </button>
  <div
    *ngIf="showForm"
    class="fixed inset-0 z-50 flex items-center justify-center bg-gray-500 bg-opacity-75"
  >
    <app-data-form
      [user]="user"
      (formSubmitted)="toggleForm()"
      (formClosed)="toggleForm()"
    ></app-data-form>
  </div>
</div>
